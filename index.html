<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="assets/css/main.css" />
</head>

<script src="assets/js/jquery-2.2.3.min.js"></script>
<script src="assets/js/setting.js"></script>
<script src="assets/js/main.js"></script>
<script src="assets/js/shapes/Point.js"></script>
<script src="assets/js/shapes/Shape.js"></script>
<script src="assets/js/shapes/basic/Rectangle.js"></script>
<script src="assets/js/shapes/basic/Equilateral.js"></script>
<script src="assets/js/shapes/basic/Ellipse.js"></script>

<script>

function download(type) {
    //设置保存图片的类型
    var imgdata = canvas.toDataURL(type);
    //将mime-type改为image/octet-stream,强制让浏览器下载
    var fixtype = function (type) {
        type = type.toLocaleLowerCase().replace(/jpg/i, 'jpeg');
        var r = type.match(/png|jpeg|bmp|gif/)[0];
        return 'image/' + r;
    }
    imgdata = imgdata.replace(fixtype(type), 'image/octet-stream')
    //将图片保存到本地
    var saveFile = function (data, filename) {
        var link = document.createElement('a');
        link.href = data;
        link.download = filename;
        var event = document.createEvent('MouseEvents');
        event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
        link.dispatchEvent(event);
    }
    var filename = new Date().toLocaleDateString() + '.' + type;
    saveFile(imgdata, filename);
}


</script>

<body onload="init()" background="back1.jpg">
    <input type="file" id="fileUpload" accept="image/*" />
    <select class="custom-select" id="inputGroupSelect01" onChange="change_font(this.selectedIndex);">
        <option selected>Arial</option>
        <option>Verdana</option>
        <option>Courier New</option>
        <option>serif</option>
        <option>sans-serif</option>
        <option>微軟正黑體</option>
        <option>新細明體</option>
        <option>標楷體</option>
    </select>
  <div id="canword">CANVAS<br>TIME</div>
  <div id="editor">Kevin's Canvas</div>
  <div id="bgwhite"></div>
  <a class="circlep" onclick="circlef();">圓形筆觸</a>
  <a class="squarep" onclick="squaref();">方形筆觸</a>
  <a class="undo" id="undo" onclick="cUndo();">Undo</a>
  <a class="redo" id="redo" onclick="cRedo();">Redo</a>
  <header>
    <div class="toolhov">
        <input id="text" onclick="chooseTool(this.id)" type="image" alt="" src="text.png" width="70px" height="70px">
        <input id="pencil" onclick="chooseTool(this.id)" type="image" alt="" src="assets/img/tools/pencil.png" width="90px" height="90px">
        <input id="eraser" onclick="chooseTool(this.id)" type="image" alt="" src="assets/img/tools/eraser.png" width="100px" height="100px">
        <input id="equilateral" onclick="chooseShape(this.id)" type="image" alt="" src="assets/img/shapes/equilateral.png" width="75px" height="75px">
        <input id="ellipse" onclick="chooseShape(this.id)" type="image" alt="" src="assets/img/shapes/ellipse.png" width="75px" height="75px">
        <input id="rectangle" onclick="chooseShape(this.id)" type="image" alt="" src="assets/img/shapes/rectangle.png" width="70px" height="70px">
    </div>    
        <div class="color-box-quick active" id="color-quick-1" style="background:black" onclick="chooseColor(this.id)"></div>
        <div class="color-box-quick" id="color-quick-2" style="background:white" onclick="chooseColor(this.id)"></div>
      <div class="color-boxx">
       
      <div style="float:left; padding:10px 10px 0px 10px;">
        <ul>
          <li><div id="#FF0000" style="background:#FF0000" onclick="pickColor(this.id)"></div></li>
          <li><div id="#00FF00" style="background:#00FF00" onclick="pickColor(this.id)"></div></li>
          <li><div id="#0000FF" style="background:#0000FF" onclick="pickColor(this.id)"></div></li>
          <li><div id="#FFFF00" style="background:#FFFF00" onclick="pickColor(this.id)"></div></li>
        </ul>
        <ul>
          <li><div id="#FF00FF" style="background:#FF00FF" onclick="pickColor(this.id)"></div></li>
          <li><div id="#00FFFF" style="background:#00FFFF" onclick="pickColor(this.id)"></div></li>
          <li><div id="#FFFFFF" style="background:#FFFFFF" onclick="pickColor(this.id)"></div></li>
          <li><div id="#000000" style="background:#000000" onclick="pickColor(this.id)"></div></li>
        </ul>
      </div>
      <input id="inputcolor" onchange="pickColor(this.value)" type="color" name="favcolor">

    </div>
    <!-- Setting -->
    
    <div class="setting-box">
      
        <input type="range" id="rangeThickness" value="20" onchange="changeThickness(this.value)">
      
      <hr id="rangeDemo"><span id="rangeValue">2px</span>
   </div>
   <button id="download" onclick="download('png');">下載圖片</button>
   <a class="clear" onclick="clearPad();">清除</a>
   
 </header>

 <div class="wrapper">
  <canvas id="canvasGrid" style="border: 20px solid rgba(155, 209, 200, 0.267)"></canvas>
  <canvas id="canvas" style="border: 20px solid rgba(155, 209, 200, 0.267)"></canvas>
  <canvas id="canvasTmp" style="border: 20px solid rgba(155, 209, 200, 0.267)"></canvas>
</div>
</body>
</html>
